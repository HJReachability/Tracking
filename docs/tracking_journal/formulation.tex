% !TEX root = tracking.tex
\section{Problem Formulation \label{sec:formulation}}
In this paper we seek to simultaneously plan and track a trajectory (or path converted to a trajectory) online and in real-time. 
The planning is done using a relatively simplified model of the system, called the planning model or planning system. 
The tracking is done by a tracking model representing the autonomous system. 
The environment may contain static obstacles that are \textit{a priori} unknown and can be observed by the system within a limited sensing range (see Section \ref{sec:online}). 
In this section we will define the tracking and planning models, as well as the goals of the paper.

\subsection{Tracking (System) Model}
The tracking model, or system model, is a representation of the autonomous system dynamics, and in general may be nonlinear and higher-dimensional than the planning model presented in Section \ref{sec:planning_model}. 
Let $\tstate$ represent the state variables of the tracking model. 
The evolution of the dynamics satisfy ordinary differential equation (ODE)

\begin{equation}
\begin{aligned}
\label{eq:tdyn}
\frac{d\tstate}{d\tvar} = \dot{\tstate} = \tdyn(\tstate(\tvar), \tctrl(\tvar), \dstb(\tvar)), \tvar \in [0, \thor], \\
\tstate(\tvar) \in \tset, \tctrl(\tvar) \in \tcset, \dstb(\tvar) \in \dset.
\end{aligned}
\end{equation}

We assume that the system dynamics $\tdyn : \tset\ \times\ \tcset \times \dset \rightarrow \tset$ are uniformly continuous, bounded, and Lipschitz continuous in the system state $\tstate$ for a fixed control and disturbance functions $\tctrl(\cdot), \dstb(\cdot)$. The control function $\tctrl(\cdot)$ and disturbance function $\dstb(\cdot)$ are drawn from the following sets:

\begin{equation}
\begin{aligned}
\tctrl(\cdot) \in \tcfset(t) = \{\phi: [0, \thor] \rightarrow \tcset: \phi(\cdot) \text{ is measurable}\}\\
\dstb(\cdot) \in \dfset(t) = \{\phi: [0, \thor] \rightarrow \dset: \phi(\cdot) \text{ is measurable}\}
\end{aligned}
\end{equation}

\noindent where $\tcset, \dset$ are compact and $t\in[0, \thor]$ for some $T>0$. Under these assumptions there exists a unique trajectory solving (\ref{eq:tdyn}) for a given $\tctrl(\cdot) \in \tcfset, \dstb(\cdot)\in\dfset$ \cite{Coddington84}. The trajectories of (\ref{eq:tdyn}) that solve this ODE will be denoted as $\ttraj(\tvar; \tstate, \tvar_0, \tctrl(\cdot), \dstb(\cdot))$, where $\tvar_0,\tvar \in [0, \thor]$ and $\tvar_0 \leq \tvar$. These trajectories will satisfy the initial condition and the ODE (\ref{eq:tdyn}) almost everywhere:

\begin{align*}
&\frac{d}{d\tvar}\ttraj(\tvar; \tstate_0, \tvar_0, \tctrl(\cdot), \dstb(\cdot)) = \\ &\qquad \tdyn(\ttraj(\tvar; \tstate_0, \tvar_0, \tctrl(\cdot), \dstb(\cdot)), \tctrl(\tvar), \dstb(\cdot)), \\
&\ttraj(\tvar_0; \tstate_0, \tvar_0, \tctrl(\cdot), \dstb(\cdot)) = \tstate_0.
\end{align*}

Let $\goal \subset \tset$ represent the set of goal states, and let $\tconstr \subset \tset$ represent state constraints that must be satisfied for all time.
Often, $\tconstr$ represents the complement of obstacles that the system must avoid; however, more generally, $\tconstr$ also represents general state constraints.

\subsection{Planning Model \label{sec:planning_model}}
The planning model is a simpler or lower-dimensional model of the system used for planning a desired trajectory or path.
For navigation in unknown environments, real-time re-planning is necessary, so the planning model is typically one for which a real-time planning algorithm exists.
For examples of planning models, see Section \ref{sec:results}.

Let $\pstate$ represent the state variables of the planning model, with control $\pctrl$. 
We assume that the planning states $\pstate \in \pset$ are a subset of the tracking states $\tstate \in \tset$, so that $\pset$ is a subspace within $\tset$.
This assumption is reasonable since a lower-fidelity model of a system typically involves a subset of the system's states, as with the numerical examples provided in this paper.
The dynamics satisfy the ODE

\begin{align}
\label{eq:pdyn}
\frac{d\pstate}{d\tvar} = \dot{\pstate} = \pdyn(\pstate, \pctrl), \tvar \in [0, \thor], \\
\pstate \in \pset, \pctrl \in \pcset
\end{align}

\noindent with the analogous assumptions on continuity and boundedness as those for \eqref{eq:tdyn}.

Note that the planning model does not involve a disturbance input. 
This is a key feature of FaSTrack: the treatment of disturbances is only necessary in the tracking model, which is modular with respect to any planning method, including those that do not account for disturbances.

Let $\goal \subset \pset$ and $\constr \subset \pset$ denote the projection of $\tgoal$ and $\tconstr$ respectively onto the subspace $\pset$.
We will assume that $\constr$ is \textbf{a priori} unknown, and must be sensed as the vehicle, or the tracking system, moves around in the environment.
Therefore, for convenience, we denote the currently known, or ``sensed'' constraints as $\constrSense(t)$.
Note that $\constrSense(t)$ depends on time, since the system may gather more information about, for example, obstacles over time.
In addition, as described throughout the paper, we will augment $\constrSense(t)$ according to the TEB between the tracking and planning systems.
We denote the augmented obstacles as $\constrAug(t)$.

\subsection{Goals and Approach}
Given system dynamics in \eqref{eq:tdyn}, initial state $\tstate_0$, goal states $\goal$, and constraints $\tconstr$ such that $\constr$ is \textit{a priori} unknown and determined in real-time, we would like to steer the system to $\goal$ with formally guaranteed satisfaction of $\tconstr$.

To achieve this goal, we propose FaSTrack, a framework that decouples the formal guarantee of safety from the planning algorithm.
Instead of having the system, represented by the tracking model, directly plan trajectories towards $\goal$, in our framework the tracking system ``chases'' the planning system, which uses any planning algorithm to obtain trajectories in real-time.
When the planning system reaches sufficiently within the goal region, the tracking system would be at the goal as well.
Safety is formally guaranteed through a precomputed of a TEB along with a corresponding tracking controller, in combination with augmentation of constraints based on this TEB.
An illustrate of our framework is shown in Figure \ref{fig:chasing}.

We demonstrate the FaSTrack framework in three representative simulations involving three different tracker system-planning system pairs, using three different planning algorithms.